# Knowledge Express
[Knowledge Express is deployed to GitHub](https://JoelHKV.github.io/Knowledge-Express/)

## General Information

Knowledge Express is an educational game that empowers you
to explore the topics that interest you the most. In this 
unique learning adventure, you take on the role of a train driver,
navigating educational content displayed on railroad signs.

Knowledge Express harnesses the power of ChatGPT to deliver
a seamless and engaging learning experience. It distills 
complex knowledge into easily digestible morsels, and enables you 
to explore them at your preferred pace. The result is an 
interactive journey that keeps you captivated along the railroad.

Join Knowledge Express and experience a fun and interactive 
way to learn today!

## Introduction

Knowledge Express is a unique first-person educational game where 
players take on the role of train drivers. The railway tracks in 
front of the train are lined with educational material presented 
on railroad signs.

### Choosing a Question


The journey begins as you find yourself in the driver's seat of 
Knowledge Express: 

<img src="https://raw.githubusercontent.com/JoelHKV/Knowledge-Express/main/public/Fig1.jpg" width="600" height="auto">


The train moves forward, passing through 
railroad signs, each displaying a question. For each sign, you 
have three choices:

- Ignore the sign: The train will continue to move forward automatically.
- Stop in front of the sign: Click once to pause in front of the sign.
- Select the sign: Click twice to choose a question.


Once you've selected a question, ChatGPT will begin processing it, 
and the chosen question will fly in front of the train. 
Meanwhile, waiting signs along the railroad will be posted.


### Reading the Answer

After ChatGPT has generated an answer, a sign displaying 
the answer will fly in front of the train. 

<img src="https://raw.githubusercontent.com/JoelHKV/Knowledge-Express/main/public/Fig2.jpg" width="600" height="auto">


After you have read the answer, click on the sign and it will fly away.


 

### Choosing a Follow-up Question


Following the answer, signs with follow-up questions will be displayed. 
This process mirrors the initial selection of a question, except 
that these are follow-up questions related to the previous answer 
generated by ChatGPT.

You can now choose a follow-up question, receive an answer, 
and access new follow-up questions. This cycle can be 
repeated as many times as desired, allowing you to delve 
deeper into topics of interest.


### Learning Cycle

Knowledge Express simplifies the learning process by incorporating 
follow-up questions alongside the answers. Users can learn by 
merely clicking away, without the need for complicated actions. 
ChatGPT continuously provides questions, and users can explore 
topics in depth by selecting the questions that pique their curiosity.


## Instructions
 
Instructions within Knowledge Express are displayed as railroad signs, 
in line with the app's overall theme. These instructions guide users 
throughout the experience and can be accessed by clicking the '?' 
button at any time. Here's an overview of the instructions:

### Welcome!

- Welcome to Knowledge Express! 
- This special train ride is all about learning.
- It teaches you nearly everything you have ever wanted to know.
- Whether you're a seasoned traveler or just starting your journey...
- These instructions will guide you through the experience.
- If you already know what to do, click MQ, WQ, or LQ to start.
- Otherwise, keep reading these instructional signs.

### Controlling the Train

- You can control the speed of the train in several different ways:
- Use the throttle lever located in the middle of the control panel.
- Turn the mouse wheel up and down.
- Click any sign once, and the train will stop in front of it.
- To resume motion, use the throttle lever, the mouse wheel, or simply click an empty part of the screen.

### Gameplay Overview

- First, you will either choose a question or type in a question.
- The WQ button will display a series of World Questions to choose from.
- The LQ button will display a series of Life Questions to choose from.
- Alternatively, the MQ (My Question) button allows you to ask whatever you want. Simply type in your question and press the "Submit" button.
- Whether you choose a question or type in a question, a red border will appear around it. This indicates that ChatGPT is thinking about the question.
- Once the answer is ready, the answer sign will "fly" right in front of the train.
- After you have read the answer, click the answer sign, and it will fly away.

### Exploring Topics

- Next, you will see a series of signs that contain follow-up questions.
- Double-click any follow-up question, and ChatGPT will start thinking about it.
- After reading the answer, you will be presented with new follow-up questions.
- By always asking the follow-up question of your interest, you can delve into any topic as deeply as you want.

### Changing Topics

- Once you are done with the topic, you can click MQ, WQ, or LQ to restart.
- Enjoy your learning journey with Knowledge Express!
- Now click MQ, WQ, or LQ to start, or press "?" to read the instructions again.

 
## Learning Promoting Features

Knowledge Express offers several unique features that foster 
effective learning:

- **Personalized Learning:** Users can dive into topics they are inherently interested in, boosting motivation compared to rigid curriculum-based learning.

- **Immediate Exploration:** Users can get inspired by new topics and dive into them immediately, preventing motivation from waning or topics from being forgotten.

- **Engaging Interactions:** Users engage in fast-paced interactions with small, digestible doses of information, a learning style well-suited for the modern world where attention spans can be limited.

- **Flexible Pacing:** Users can control the speed of the train, determining the rate at which they receive information, making it suitable for both fast and slow learners.

- **Fun and Interactive:** Learning becomes an enjoyable activity, as users embark on a fun journey while acquiring knowledge.

- **Motion-Enhanced Learning:** Users experience motion while learning, making the process more engaging and enjoyable.

## Architecture

The app is strictly divided into regular React components 
(e.g., ```TrainControlBlock```) and the 3D scene (```THREESceneBlock```). 
All 3D subcomponents start with ```THREE...```.

To make the app as performant as possible, the following 
techniques were implemented:

- Prop drilling instead of the blind use of a state management library
- Memoization
- Extensive use of ```useRef``` instead of ```useState```

Special emphasis was placed on avoiding unnecessary re-renders. 
For example, the train speed is treated globally as a 
ref (```trainSpeedRef```) so that speed changes do not trigger 
re-rendering of the whole scene. However, it is also 
treated locally as a state in ```TrainControlBlock``` to 
update the throttle lever.

In addition, subcomponents in the 3D scene, particularly the signs, 
were made as autonomous as possible. They fully manage themselves, 
are never re-rendered from the top-down, and only require two 
pieces of data: a) the position of the train and b) a sign 
ID indicating which sign has been made active 
(in order to deactivate if another sign has been clicked).

This project is rather simple and does not necessarily require 
the techniques discussed above. They were implemented, however, 
to learn how to handle similar yet more complicated projects in the future.

## Getting Started
To run this React app locally, follow these 5 steps:
1. **Clone the Repository:**
```
git clone https://github.com/JoelHKV/Knowledge-Express.git
```
2. **Navigate to the Project Directory:**
```
cd your-react-app
```
3. **Install Dependencies:**
```
npm install
```
4. **Start the Development Server:**
```
npm run dev
```
5. **API Accecss:**

If you wish to use this API, please refer to [API Access](#api-access) 
for details. If you prefer to test this app with mock data, navigate 
to App.jsx and locate the following two lines:

```
   const { questionAnswerData, loaded, error } = fetchQandA(cloudFunctionURL, thisQuestion); // fetch real data from the API
    //const { questionAnswerData, loaded, error } = fetchMockQandA(cloudFunctionURL, thisQuestion); // mimic fetch and generate mock data
```
To use mock data, simply comment out the first line (hook for real data) 
and uncomment the second line (hook for mock data).


## Folder Structure
The project directory is organized as follows:

* src/: This folder contains the main source code
* main.jsx: The JavaScript entry point
* App.jsx: The main entry point
* App.css: The main CSS styles specific to App.jsx
* assets/: Stores static assets like images, fonts, etc
* components/: Houses React components (all 3D scene components start with ```THREE...```)
* hooks/: Contains custom React hooks
* utilities/: Holds utility functions
* backend/: Contains python scripts for prompting ChatGPT
* testing_scripts/: Contains testing scripts

## Data

Under the hood, Knowledge Express uses ChatGPT 3.5. Most commonly 
requested data is stored in Google Firestore, and unique data is 
prompted on the spot. A special-purpose Google Cloud Function 
was developed to serve as an API for providing both saved and live data.


### Generation of Initial Data

Knowledge Express initially contains 100 world questions and 100 
life questions. These questions were created by manually 
prompting ChatGPT 3.5. The answers and follow-up questions 
for these inquiries were generated using the following Python scripts:

 ```
def answer_and_related_questions(question):
    text = '''
    Provide an 80-word answer to this question: """ ''' + question + ''' """. Give your answer
    as a summary, not a list. Based on your answer, also provide seven follow-up questions. 
    Place a hashtag (#) before and after every question and answer. 
    Do not answer the follow up questions or write anything extra."
    '''    

    message_log = [
    {"role": "system", "content": text}
    ]
    response_content = chat_completion_create(message_log)

    return response_content
     
     
def chat_completion_create(message_log):
    response = openai.ChatCompletion.create(
    model="gpt-3.5-turbo",  # The name of the OpenAI chatbot model to use
    messages=message_log,   # The conversation history up to this point, as a list of dictionaries
    max_tokens=980,        # The maximum number of tokens (words or subwords) in the generated response
    stop=None,              # The stopping sequence for the generated response, if any (not used here)
    temperature=0.0,        # The "creativity" of the generated response (higher temperature = more creative)
    )
    return response.choices[0].message.content


```
The ChatGPT output was then filtered and arranged 
into dictionaries using the following script (```chat_gpt_data_generation.py```).

Finally, the initial data was saved to Firestore with the following schema:
 - **`knowledgeExpress`** (Collection)
    - **`[Question]`** (Document)
        - **`answer`** (String): A concise answer (about 80 words) to the question
        - **`q1`** (String): 1st follow-up question 
        - **`q2`** (String): 2nd follow-up question 
        - **...**
        - **`q6`** (String): 6th follow-up question 
 
### Cloud Function to Serve Data

The special-purpose Cloud Function performs the following tasks:

- Checks the permissions of the request.
- Verifies if the requested data is stored in Firestore.
- If the data is found in Firestore, it retrieves the data.
- If not, it prompts ChatGPT to generate data, similar to the creation of initial data.
- Finally, it returns the data.

#### API Access 

To ensure the security and reliability of this API, the 
Cloud Function first checks the URL and the IP address 
of the request. Automatic access is granted to the URL 
of the deployed version and the IP address of my own 
development server.

If you wish to use this API, please don't hesitate to 
contact the [Project owner](#contact-information).

#### API Endpoint 

Use the API as follows:
- **URL:** `https://europe-north1-koira-363317.cloudfunctions.net/knowledgeExpressRequest?question=ENTER_QUESTION_HERE`
- **Description:** Returns json with keys "answer", "q1", "q2", "q3", "q4", "q5", and "q6"
- **Usage:** Replace `ENTER_QUESTION_HERE` with the question and make a GET request to the URL.

A request returns JSON that looks as follows:

```
{"answer":"GitHub is a web-based platform for 
version control and collaboration that allows 
developers to store and manage their code repositories. 
It provides tools for tracking changes, managing branches, 
and facilitating collaboration among team members. ",
"q1":"What are some key features of GitHub? ",
"q2":"How does GitHub help with version control? ",
"q3":"Can GitHub be used for both personal and professional projects? ",
"q4":"What are some alternatives to GitHub? ",
"q5":"How does GitHub facilitate collaboration among developers? ",
"q6":"Can GitHub be used for non-coding projects? "}
```

### ChatGPT 3.5 Output

#### Quality of Data


The quality of the data is ultimately a matter of subjective evaluation. 
It is worth noting, however, that Large Language Models are inherently 
designed for giving verbal answers to verbal questions, and they are 
trained with a large amount of data from the internet. Thus, if there 
is any task that ChatGPT 3.5 is good at, it is providing answers to 
questions for which the internet is full of information.

The quality of the follow-up questions is somewhat lower. 
For learners interested in the big picture, the quality is 
sufficient, but for learners interested in delving into 
the details, the questions might become a bit repetitive 
and boring. This is a feature of ChatGPT 3.5 that is 
addressed by giving users the option to type in their 
own follow-up questions.

#### Prompting Challenges

The major challenge in ChatGPT 3.5 prompting is that the output 
formatting is inconsistent. This occasionally occurs no matter 
how precisely ChatGPT is asked to provide the output in a certain 
format. Setting the creativity to zero (temperature=0) does not 
solve this problem either.

After a fair amount of trial and error (e.g., requesting JSON), 
the most robust method was to ensure that the output data 
contains unique delimiters (#). Then, the output string was 
manually parsed into JSON. This is also a matter of trial 
and error, as ChatGPT tends to change the output format slightly.

Occasionally, ChatGPT fails to count up to 6 exactly. 
To overcome this, we requested 7 follow-up questions 
and selected the first 6.

## Technologies Used
The frontend is written in JavaScript (React and `@react-three/fiber` for 
the 3D scene), HTML, and CSS. The backend is written in Python.

## Testing
## Known Issues
## Roadmap
- Railroad signs could convey information beyond text. 
For example, more abstract questions could be positioned 
higher than concrete questions. Answer signs could also be color-coded, 
indicating how confident ChatGPT is about the answer.

## Contact Information

For inquiries or collaboration opportunities, please feel free to contact me via email. 
My name is listed on the [Profile page](https://github.com/JoelHKV), and I am using Gmail.

